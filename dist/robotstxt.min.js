/*! @playfulsparkle/robotstxt-js v1.0.8 | Copyright (c) 2025-present, Zsolt Oroszl√°ny <hello@playfulsparkle.com> | BSD-3-Clause */
(()=>{class i{constructor(e,t){this.re={specialChars:/[.^+?(){}[\]|\\]/g,nonGreedyWildcard:/\*/g},this.type=e,this.path=t,this.regex=this.createRegex(t)}match(e){return this.regex.test(e)}createRegex(e){e=e.replace(this.re.specialChars,"\\$&").replace(this.re.nonGreedyWildcard,".*?");return new RegExp("^"+e)}}class p{constructor(e){this.userAgent=e,this.crawlDelay=void 0,this.cacheDelay=void 0,this.rules=[],this.comment=[],this.robotVersion=void 0,this.visitTime=void 0,this.requestRates=[]}getName(){return this.userAgent}getComment(){return this.comment}getRobotVersion(){return this.robotVersion}getVisitTime(){return this.visitTime}getRequestRates(){return this.requestRates}getCacheDelay(){return this.cacheDelay}getCrawlDelay(){return this.crawlDelay}getRules(){return this.rules}addRule(e,t){if(void 0===e)throw new Error('The "type" parameter is required.');if(void 0===t)throw new Error('The "path" parameter is required.');this.rules.push(new i(e,t))}}class t{constructor(e){this.groups=[],this.sitemaps=[],this.cleanParam=[],this.host=void 0,this.reports=[],this.re={robotVersion:/^[12]\.0$/,requestRate:/^\d+\/\d+[smh]?\s+(\d{4})-(\d{4})$/,visitTime:/^(\d{4})-(\d{4})$/,eol:/\r\n|\r|\n/,inlineComment:/(?:\s|^)#/,pathForwardSlash:/\/+/g},this.parse(e)}parse(e){if(void 0===e)throw new Error('The "content" parameter is required.');var r=[],i=e.split(this.re.eol);for(let t=0;t<i.length;t++){var s=i[t].trim();if(s&&"#"!==s[0]){var a=s.indexOf(":");if(-1!==a){var l=s.slice(0,a).trim().toLowerCase();let e=s.slice(a+1).trim();s=e.search(this.re.inlineComment);-1!==s&&(e=e.slice(0,s).trim()),l&&e&&r.push({index:t,directive:l,value:e})}}}let o=[],h=!1,t=!1,n={};var u=["allow","disallow","noindex","comment","robot-version","request-rate","visit-time","cache-delay","crawl-delay"];for(let e=0;e<r.length;e++){let i=r[e];var c=-1!==u.indexOf(i.directive)&&!t;if("user-agent"!==i.directive&&!c||(t=!0,c=c?"*":i.value,-1!==!o.indexOf(c)&&o.push(c),n[c])||(n[c]=new p(c)),"allow"===i.directive){let t=this.normalizePath(i.value);o.forEach(e=>n[e].addRule("allow",t)),h=!0}else if("disallow"===i.directive){let t=this.normalizePath(i.value);o.forEach(e=>n[e].addRule("disallow",t)),h=!0}else if("noindex"===i.directive){let t=this.normalizePath(i.value);o.forEach(e=>n[e].addRule("noindex",t)),h=!0}else if("cache-delay"===i.directive){let t=+i.value;if(isNaN(t)){this.reports.push(`Invalid Cache-delay directive value: "${i.value}".`);continue}if(t<=0){this.reports.push(`Cache-delay must be a positive number. The provided value is ${t}.`);continue}o.forEach(e=>{n[e].cacheDelay||(n[e].cacheDelay=t)}),h=!0}else if("crawl-delay"===i.directive){let t=+i.value;if(isNaN(t)){this.reports.push(`Invalid Crawl-Delay directive value: "${i.value}".`);continue}if(t<=0){this.reports.push(`Crawl-Delay must be a positive number. The provided value is ${t}.`);continue}o.forEach(e=>{n[e].crawlDelay||(n[e].crawlDelay=t)}),h=!0}else if("comment"===i.directive)o.forEach(e=>n[e].comment.push(i.value)),h=!0;else if("robot-version"===i.directive){if(!this.re.robotVersion.test(i.value)){this.reports.push(`Invalid Robot-Version directive value: "${i.value}".`);continue}o.forEach(e=>n[e].robotVersion=i.value),h=!0}else if("request-rate"===i.directive){c=i.value.match(this.re.requestRate);if(!c){this.reports.push(`Invalid Request-rate directive value: "${i.value}".`);continue}if(c[1]&&c[2]){var d=c[1],c=c[2];if(!this.isValidTime(d)||!this.isValidTime(c)){this.reports.push(`Invalid Request-rate directive start-end time format: "${d}-${c}".`);continue}}o.forEach(e=>n[e].requestRates.push(i.value)),h=!0}else if("visit-time"===i.directive){d=i.value.match(this.re.visitTime);if(!d){this.reports.push(`Invalid Visit-time directive value: "${i.value}".`);continue}if(d[1]&&d[2]){var c=d[1],v=d[2];if(!this.isValidTime(c)||!this.isValidTime(v)){this.reports.push(`Invalid Visit-time directive start-end time format: "${c}-${v}".`);continue}}o.forEach(e=>n[e].visitTime=i.value),h=!0}else"sitemap"===i.directive?this.sitemaps.push(i.value):"clean-param"===i.directive?this.cleanParam.push(i.value):"host"===i.directive&&(this.host=i.value);c=r[e+1];c&&h&&"user-agent"===c.directive&&(h=!1,o=[])}this.groups=Object.keys(n).map(e=>n[e])}getReports(){return this.reports}isAllowed(e,t){if(void 0===e)throw new Error('The "url" parameter is required.');if(void 0===t)throw new Error('The "userAgent" parameter is required.');var i,r,t=this.getApplicableRules(t),s=this.normalizeUrlPath(e),a=[];for(i of t)i.match(s)&&a.push(i);if(0===a.length)return!0;let l=a[0];for(r of a){var o=this.getRuleSpecificity(r.path);this.getRuleSpecificity(l.path)<o&&(l=r)}return"allow"===l.type}isDisallowed(e,t){return!this.isAllowed(e,t)}getSitemaps(){return this.sitemaps}getCleanParams(){return this.cleanParam}getHost(){return this.host=void 0}getGroup(t){if(t)for(let e=0;e<this.groups.length;e++){var i=this.groups[e];if(i.userAgent.toLowerCase()===t.toLowerCase())return i}}getRuleSpecificity(e){let t=e.length;return-1!==e.indexOf("*")?t-=.5:"$"===e.slice(-1)&&(t+=.5),t}getApplicableGroups(t){var e=this.groups.filter(e=>e.getName().toLowerCase()===t.toLowerCase());return 0<e.length?e:this.groups.filter(e=>"*"===e.getName())}getApplicableRules(e){return this.getApplicableGroups(e).reduce((e,t)=>e.concat(t.getRules()),[])}normalizeUrlPath(t){try{return this.normalizePath(new URL(t).pathname)}catch(e){return this.normalizePath(t)}}normalizePath(t){let i;try{i=decodeURIComponent(t)}catch(e){i=t}t=i.replace(this.re.pathForwardSlash,"/");return"/"===t[0]?t:"/"+t}isValidTime(e){var t=parseInt(e.substring(0,2),10),e=parseInt(e.substring(2,4),10);return 0<=t&&t<=23&&0<=e&&e<=59}}function e(e){return new t(e)}"undefined"!=typeof exports&&(exports.robotstxt=e),"undefined"!=typeof window&&(window.robotstxt=e,"function"==typeof define)&&define.amd&&define(()=>({robotstxt:e}))})();
//# sourceMappingURL=robotstxt.min.js.map
